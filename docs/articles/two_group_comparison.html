<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>two_group_comparison • neuroSCC</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="two_group_comparison">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">neuroSCC</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.16.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/iguanamarina/neuroSCC" aria-label="GitHub repository"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>two_group_comparison</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/iguanamarina/neuroSCC/blob/HEAD/vignettes/two_group_comparison.Rmd" class="external-link"><code>vignettes/two_group_comparison.Rmd</code></a></small>
      <div class="d-none name"><code>two_group_comparison.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette demonstrates a minimal example of performing a
<strong>group vs. group</strong> SCC analysis using the
<code>neuroSCC</code> package.</p>
<p>It is recommended that you first complete the <a href="landing_vignette.html">“Getting Started”</a> vignette. If you
haven’t, the following section will guide you through the necessary data
preparation.</p>
<hr>
</div>
<div class="section level2">
<h2 id="data-preparation-conditional">Data Preparation (Conditional)<a class="anchor" aria-label="anchor" href="#data-preparation-conditional"></a>
</h2>
<p>First, let’s conditionally prepare the required data (control and
pathological matrices). We use sample data included in the package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Recreate necessary data from sample files</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Creating sample data for 2-group comparison...\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Creating sample data for 2-group comparison...</span></span>
<span></span>
<span><span class="co"># Create databases for Control and Pathological groups</span></span>
<span><span class="va">databaseControls</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/databaseCreator.html">databaseCreator</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"^syntheticControl[12]\\.nii\\.gz$"</span>, control <span class="op">=</span> <span class="cn">TRUE</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">databasePathological</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/databaseCreator.html">databaseCreator</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"^syntheticPathological[12]\\.nii\\.gz$"</span>, control <span class="op">=</span> <span class="cn">FALSE</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create matrices suitable for SCC</span></span>
<span><span class="va">matrixControls</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/matrixCreator.html">matrixCreator</a></span><span class="op">(</span><span class="va">databaseControls</span>, paramZ <span class="op">=</span> <span class="fl">35</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">matrixPathological</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/matrixCreator.html">matrixCreator</a></span><span class="op">(</span><span class="va">databasePathological</span>, paramZ <span class="op">=</span> <span class="fl">35</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Normalize matrices</span></span>
<span><span class="va">normalizedControls</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/meanNormalization.html">meanNormalization</a></span><span class="op">(</span><span class="va">matrixControls</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Mean before normalization: 4.345851</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Normalization completed.</span></span>
<span><span class="va">normalizedPathological</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/meanNormalization.html">meanNormalization</a></span><span class="op">(</span><span class="va">matrixPathological</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Mean before normalization: 4.240851</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Normalization completed.</span></span>
<span></span>
<span><span class="co"># Extract contours from a control subject for SCC triangulation</span></span>
<span><span class="va">niftiPath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"syntheticControl1.nii.gz"</span>, package <span class="op">=</span> <span class="st">"neuroSCC"</span><span class="op">)</span></span>
<span><span class="va">contours</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/neuroContour.html">neuroContour</a></span><span class="op">(</span><span class="va">niftiPath</span>, paramZ <span class="op">=</span> <span class="fl">35</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, plotResult <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Data preparation completed successfully.\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Data preparation completed successfully.</span></span></code></pre></div>
<hr>
</div>
<div class="section level2">
<h2 id="scc-estimation-group-vs-group">SCC Estimation (Group vs Group)<a class="anchor" aria-label="anchor" href="#scc-estimation-group-vs-group"></a>
</h2>
<p>The SCC estimation step is computationally intensive and thus
typically skipped in vignette demonstrations. Below, we conditionally
load a precomputed SCC result provided with the package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_file</span> <span class="op">&lt;-</span> <span class="st">"SCCcomp.RData"</span></span>
<span><span class="va">scccomp_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="va">result_file</span>, package <span class="op">=</span> <span class="st">"neuroSCC"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">scccomp_path</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Precomputed SCC group comparison found. Loading data...\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="va">scccomp_path</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Precomputed SCC data not found. Actual computation is skipped due to computational complexity.\n"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># The following code shows how to perform the SCC computation (skipped by default)</span></span>
<span>  <span class="va">SCCcomp</span> <span class="op">&lt;-</span> <span class="fu">ImageSCC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ImageSCC/man/scc.image.html" class="external-link">scc.image</a></span><span class="op">(</span></span>
<span>    Ya <span class="op">=</span> <span class="va">normalizedPathological</span>,</span>
<span>    Yb <span class="op">=</span> <span class="va">normalizedControls</span>,</span>
<span>    Z <span class="op">=</span> <span class="va">contours</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    d.est <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    d.band <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    r <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    V.est.a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">contours</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    Tr.est.a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">contours</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    V.band.a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">contours</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    Tr.band.a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">contours</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    penalty <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    lambda <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="fl">3</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">}</span>,</span>
<span>    alpha.grid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.10</span>, <span class="fl">0.05</span>, <span class="fl">0.01</span><span class="op">)</span>,</span>
<span>    adjust.sigma <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">SCCcomp</span>, file <span class="op">=</span> <span class="va">result_file</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<hr>
</div>
<div class="section level2">
<h2 id="extracting-significant-points-and-evaluating-metrics">Extracting Significant Points and Evaluating Metrics<a class="anchor" aria-label="anchor" href="#extracting-significant-points-and-evaluating-metrics"></a>
</h2>
<p>With the SCC results (<code>SCCcomp</code>) loaded, we extract the
significant regions and evaluate their performance against known ground
truth ROIs.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract significant points from SCC results</span></span>
<span><span class="va">significantPoints</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getPoints.html">getPoints</a></span><span class="op">(</span><span class="va">SCCcomp</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load true ROI data provided within the package</span></span>
<span><span class="va">roi_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ROIsample_Region2_18.nii.gz"</span>, package <span class="op">=</span> <span class="st">"neuroSCC"</span><span class="op">)</span></span>
<span><span class="va">trueROI</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/processROIs.html">processROIs</a></span><span class="op">(</span><span class="va">roi_path</span>, region <span class="op">=</span> <span class="st">"Region2"</span>, number <span class="op">=</span> <span class="st">"18"</span>, save <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading NIfTI file...</span></span>
<span></span>
<span><span class="co"># Get total coordinate dimensions</span></span>
<span><span class="va">dimensions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getDimensions.html">getDimensions</a></span><span class="op">(</span><span class="va">roi_path</span><span class="op">)</span></span>
<span><span class="va">totalCoords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">dimensions</span><span class="op">$</span><span class="va">xDim</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">dimensions</span><span class="op">$</span><span class="va">yDim</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate metrics to evaluate detection performance</span></span>
<span><span class="va">metrics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculateMetrics.html">calculateMetrics</a></span><span class="op">(</span></span>
<span>  detectedPoints <span class="op">=</span> <span class="va">significantPoints</span><span class="op">$</span><span class="va">positivePoints</span>,</span>
<span>  truePoints <span class="op">=</span> <span class="va">trueROI</span>,</span>
<span>  totalCoords <span class="op">=</span> <span class="va">dimensions</span>,</span>
<span>  regionName <span class="op">=</span> <span class="st">"Group_vs_Group"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display calculated metrics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">metrics</span><span class="op">)</span></span>
<span><span class="co">#&gt;           region sensitivity specificity      PPV      NPV</span></span>
<span><span class="co">#&gt; 1 Group_vs_Group    85.12872    95.62596 97.22839 78.10603</span></span></code></pre></div>
<hr>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>In this vignette, you’ve seen a concise example of conducting a
<strong>group vs group SCC analysis</strong> using the
<code>neuroSCC</code> package. We’ve used sample data provided by the
package to illustrate the workflow clearly, focusing on practical
application and evaluation of results.</p>
<p>Actual SCC computations are computationally intensive and thus
skipped in this vignette. Instead, we’ve loaded precomputed results. You
can adapt this template for your own datasets, adjusting parameters and
experimenting further according to your specific research needs.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Juan A. Arias Lopez.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
