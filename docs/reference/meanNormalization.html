<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Mean Normalization for Matrix Data — meanNormalization • neuroSCC</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Mean Normalization for Matrix Data — meanNormalization"><meta name="description" content="Normalizes each row of a matrix by dividing its elements by the row mean, ignoring NA values.
This step is commonly used to adjust for global intensity differences across subjects before
applying statistical comparisons or functional data analysis."><meta property="og:description" content="Normalizes each row of a matrix by dividing its elements by the row mean, ignoring NA values.
This step is commonly used to adjust for global intensity differences across subjects before
applying statistical comparisons or functional data analysis."><meta property="og:image" content="https://iguanamarina.github.io/neuroSCC/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">neuroSCC</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/iguanamarina/neuroSCC" aria-label="GitHub repository"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Mean Normalization for Matrix Data</h1>
      <small class="dont-index">Source: <a href="https://github.com/iguanamarina/neuroSCC/blob/HEAD/R/meanNormalization.R" class="external-link"><code>R/meanNormalization.R</code></a></small>
      <div class="d-none name"><code>meanNormalization.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Normalizes each row of a matrix by dividing its elements by the row mean, ignoring <code>NA</code> values.
This step is commonly used to adjust for global intensity differences across subjects before
applying statistical comparisons or functional data analysis.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">meanNormalization</span><span class="op">(</span></span>
<span>  <span class="va">matrixData</span>,</span>
<span>  handleInvalidRows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"warn"</span>, <span class="st">"error"</span>, <span class="st">"omit"</span><span class="op">)</span>,</span>
<span>  returnDetails <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-matrixdata">matrixData<a class="anchor" aria-label="anchor" href="#arg-matrixdata"></a></dt>
<dd><p>A <code>matrix</code> where each row represents one subject’s PET data,
typically generated by <code><a href="matrixCreator.html">matrixCreator</a></code>.</p></dd>


<dt id="arg-handleinvalidrows">handleInvalidRows<a class="anchor" aria-label="anchor" href="#arg-handleinvalidrows"></a></dt>
<dd><p><code>character</code>. Specifies how to handle rows with invalid means (either zero or <code>NA</code>).
Options include <code>"warn"</code> (default), <code>"error"</code>, or <code>"omit"</code>.</p></dd>


<dt id="arg-returndetails">returnDetails<a class="anchor" aria-label="anchor" href="#arg-returndetails"></a></dt>
<dd><p><code>logical</code>. If <code>TRUE</code>, returns a list with the normalized matrix and
additional diagnostics. If <code>FALSE</code> (default), returns only the normalized matrix.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p><code>logical</code>. If <code>TRUE</code>, suppresses console messages. Default is <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A normalized matrix, or a list if <code>returnDetails = TRUE</code>.</p><ul><li><p><code>normalizedMatrix</code> – The normalized matrix.</p></li>
<li><p><code>problemRows</code> – Indices of rows that had zero or <code>NA</code> means.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function performs the following steps</p><ol><li><p>Computes the row means of the input matrix, ignoring <code>NA</code>s.</p></li>
<li><p>Divides each row by its corresponding mean.</p></li>
<li><p>Replaces <code>NaN</code> values (from division by 0) with <code>0</code> if applicable.</p></li>
<li><p>Handles problematic rows according to the selected <code>handleInvalidRows</code> option:
        <code>"warn"</code> (default) issues a warning, <code>"error"</code> stops execution,
        and <code>"omit"</code> removes the affected rows from the result.</p></li>
</ol><p>This step is often used prior to applying SCC methods to ensure comparability across subjects.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="matrixCreator.html">matrixCreator</a></code> for building the matrix input to normalize.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Generate a minimal database and create a matrix (1 control subject)</span></span></span>
<span class="r-in"><span><span class="va">dataDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"neuroSCC"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">controlPattern</span> <span class="op">&lt;-</span> <span class="st">"^syntheticControl1\\.nii\\.gz$"</span></span></span>
<span class="r-in"><span><span class="va">databaseControls</span> <span class="op">&lt;-</span> <span class="fu"><a href="databaseCreator.html">databaseCreator</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="va">controlPattern</span>,</span></span>
<span class="r-in"><span>                                    control <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                                    quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">matrixControls</span> <span class="op">&lt;-</span> <span class="fu"><a href="matrixCreator.html">matrixCreator</a></span><span class="op">(</span><span class="va">databaseControls</span>, paramZ <span class="op">=</span> <span class="fl">35</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Normalize the matrix (with diagnostics)</span></span></span>
<span class="r-in"><span><span class="va">normalizationResult</span> <span class="op">&lt;-</span> <span class="fu">meanNormalization</span><span class="op">(</span><span class="va">matrixControls</span>,</span></span>
<span class="r-in"><span>                                         returnDetails <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                                         quiet <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Mean before normalization: 4.349632</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Normalization completed.</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Juan A. Arias Lopez.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

